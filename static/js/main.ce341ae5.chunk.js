(this.webpackJsonppiano=this.webpackJsonppiano||[]).push([[0],{24:function(e,t,a){"use strict";a.r(t);var r=a(0),n=a.n(r),c=a(2),o=a.n(c),s=(a(9),a(3));let i;function l(e){switch(e.key){case i.C:return 12*e.octave+0+12;case i.CSharp:return 12*e.octave+1+12;case i.D:return 12*e.octave+2+12;case i.DSharp:return 12*e.octave+3+12;case i.E:return 12*e.octave+4+12;case i.F:return 12*e.octave+5+12;case i.FSharp:return 12*e.octave+6+12;case i.G:return 12*e.octave+7+12;case i.GSharp:return 12*e.octave+8+12;case i.A:return 12*e.octave+9+12;case i.ASharp:return 12*e.octave+10+12;case i.B:return 12*e.octave+11+12}}function u(e){const t=Math.floor(e/12)-1;switch(e%12){case 0:return{key:i.C,octave:t};case 1:return{key:i.CSharp,octave:t};case 2:return{key:i.D,octave:t};case 3:return{key:i.DSharp,octave:t};case 4:return{key:i.E,octave:t};case 5:return{key:i.F,octave:t};case 6:return{key:i.FSharp,octave:t};case 7:return{key:i.G,octave:t};case 8:return{key:i.GSharp,octave:t};case 9:return{key:i.A,octave:t};case 10:return{key:i.ASharp,octave:t};case 11:return{key:i.B,octave:t};default:return{key:i.C,octave:0}}}function _(e){return e.key.toUpperCase()+e.octave}!function(e){e.C="C",e.CSharp="C#",e.D="D",e.DSharp="D#",e.E="E",e.F="F",e.FSharp="F#",e.G="G",e.GSharp="G#",e.A="A",e.ASharp="A#",e.B="B"}(i||(i={}));const p=[{firstNote:{key:i.C,octave:3},keys:["z","s","x","d","c","v","g","b","h","n","j","m",",","l",".",";","/","\\","]"]},{firstNote:{key:i.C,octave:4},keys:["q","2","w","3","e","r","5","t","6","y","7","u","i","9","o","0","p","@","^","["]},{firstNote:{key:i.A,octave:5},keys:["Enter"]}];function h(e,t){if(e.repeat)return;const a=p.find(t=>t.keys.includes(e.key));if(!a)return;const r=a.keys.indexOf(e.key);return n=a.firstNote,c=r+t,u(l(n)+c);var n,c}const d=["accordion","acoustic_bass","acoustic_grand_piano","acoustic_guitar_nylon","acoustic_guitar_steel","agogo","alto_sax","applause","bagpipe","banjo","baritone_sax","bassoon","bird_tweet","blown_bottle","brass_section","breath_noise","bright_acoustic_piano","celesta","cello","choir_aahs","church_organ","clarinet","clavinet","contrabass","distortion_guitar","drawbar_organ","dulcimer","electric_bass_finger","electric_bass_pick","electric_grand_piano","electric_guitar_clean","electric_guitar_jazz","electric_guitar_muted","electric_piano_1","electric_piano_2","english_horn","fiddle","flute","french_horn","fretless_bass","fx_1_rain","fx_2_soundtrack","fx_3_crystal","fx_4_atmosphere","fx_5_brightness","fx_6_goblins","fx_7_echoes","fx_8_scifi","glockenspiel","guitar_fret_noise","guitar_harmonics","gunshot","harmonica","harpsichord","helicopter","honkytonk_piano","kalimba","koto","lead_1_square","lead_2_sawtooth","lead_3_calliope","lead_4_chiff","lead_5_charang","lead_6_voice","lead_7_fifths","lead_8_bass__lead","marimba","melodic_tom","music_box","muted_trumpet","oboe","ocarina","orchestra_hit","orchestral_harp","overdriven_guitar","pad_1_new_age","pad_2_warm","pad_3_polysynth","pad_4_choir","pad_5_bowed","pad_6_metallic","pad_7_halo","pad_8_sweep","pan_flute","percussive_organ","piccolo","pizzicato_strings","recorder","reed_organ","reverse_cymbal","rock_organ","seashore","shakuhachi","shamisen","shanai","sitar","slap_bass_1","slap_bass_2","soprano_sax","steel_drums","string_ensemble_1","string_ensemble_2","synth_bass_1","synth_bass_2","synth_brass_1","synth_brass_2","synth_choir","synth_drum","synth_strings_1","synth_strings_2","taiko_drum","tango_accordion","telephone_ring","tenor_sax","timpani","tinkle_bell","tremolo_strings","trombone","trumpet","tuba","tubular_bells","vibraphone","viola","violin","voice_oohs","whistle","woodblock","xylophone"];function b(e){const t=e.map(e=>l(e)),a=Math.min(...t),r=u(a),n=Array(11).fill(null).map((e,t)=>t+1).filter(e=>t.some(t=>(t-a)%12===e)),c=Object.keys(m).map(e=>({label:e,score:y(n,m[e])}));return{key:r.key,...c.reduce((e,t)=>e.score>=t.score?e:t)}}const m={5:[7],"":[4,7],m:[3,7],aug:[4,8],dim:[3,6],sus2:[2,7],sus4:[5,7],M7:[4,7,11],m7:[3,7,10],7:[4,7,10],"7\u266d5":[4,6,10],"7sus4":[5,7,10],mM7:[3,7,11],dim7:[3,6,11],"\xf87":[3,6,10],M9:[2,4,7,11],m9:[2,3,7,10],M11:[2,4,5,7,11],m11:[2,3,5,7,10],M13:[2,4,6,7,9,11],m13:[2,3,5,7,9,10]};function y(e,t){const a=[1,2,3,4,5,6,7,8,9,10,11];return a.map(r=>e.includes(r)?t.includes(r)?1/a.filter(e=>t.includes(e)).length:-1/a.filter(e=>!t.includes(e)).length:0).reduce((e,t)=>e+t)}let f=null;function k(){const[e,t]=Object(r.useState)([]),[a,c]=Object(r.useState)({}),[o,i]=Object(r.useState)("acoustic_grand_piano"),[p,m]=Object(r.useState)(10),[y,k]=Object(r.useState)(0),v=Object(r.useCallback)(function(e,t,a,r,n,c){return async o=>{const s=h(o,c);if(s){console.log(_(s));const c=await async function(e,t,a,r){if(r([_(e)+" - PLAY",...t.splice(0,16)]),!f)return;return f.play(_(e),void 0,{release:a})}(s,e,n,t);if(!c)return;r({...a,[l(s)]:[...a[l(s)]||[],{stop:()=>c.stop()}]})}}}(e,t,a,c,p,y),[e,a]),w=Object(r.useCallback)(function(e,t,a,r,n){return async c=>{const o=h(c,n);o&&(console.log(_(o)),await async function(e,t,a,r){r([_(e)+" - STOP",...a.splice(0,16)]),t.forEach(e=>e.stop())}(o,a[l(o)]||[],e,t),r({...a,[l(o)]:void 0}))}}(e,t,a,c,y),[e,a]),C=Object(r.useCallback)(function(e){return t=>{e(t.target.value)}}(i),[]),S=Object(r.useCallback)(g(m),[]),E=Object(r.useCallback)(g(k),[]),j=Object(r.useCallback)((x=o,async()=>{f=await Object(s.instrument)(new AudioContext,x)}),[o]);var x;const O=Object.keys(a).filter(e=>a[e]).map(e=>u(Number(e)));return n.a.createElement("div",{onKeyDown:v,onKeyUp:w,tabIndex:0},n.a.createElement("div",null,"Instrument:",n.a.createElement("select",{onChange:C,defaultValue:"acoustic_grand_piano"},d.map((e,t)=>n.a.createElement("option",{key:t,value:e},e.split("_").map(e=>e?e[0].toUpperCase()+e.substr(1):e).join(" "))))),n.a.createElement("div",null,"Transpose:",n.a.createElement("input",{onChange:E,defaultValue:String(y)})),n.a.createElement("div",null,"Release:"," ",n.a.createElement("input",{onChange:S,defaultValue:String(p)})),n.a.createElement("div",null,n.a.createElement("button",{onClick:j},"Start")),n.a.createElement("p",null,"Playing:",O.map(e=>_(e)).join(", ")||"-"),n.a.createElement("p",null,"Guess:",function(e){if(0===e.length)return"N/A";const t=e.map(e=>l(e)),a=u(Math.min(...t)),r=b(e),n=b(e.filter(e=>e.key!==a.key));return r.score<n.score?`${n.key}${n.label}/${a.key} (${Math.ceil(100*n.score)}%)`:`${a.key}${r.label} (${Math.ceil(100*r.score)}%)`}(O)))}function g(e){return t=>{e(Number(t.target.value))}}Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));o.a.render(n.a.createElement(k,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(e=>{e.unregister()})},4:function(e,t,a){e.exports=a(24)},9:function(e,t,a){}},[[4,1,2]]]);
//# sourceMappingURL=main.ce341ae5.chunk.js.map